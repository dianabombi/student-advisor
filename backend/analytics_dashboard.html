<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODEX Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .login-section {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            margin: 0 auto;
        }

        .login-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .dashboard {
            display: none;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .value {
            color: #667eea;
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            color: #999;
            font-size: 0.9em;
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .chart-container h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        table {
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        table tr:hover {
            background: #f8f9ff;
        }

        .positive {
            color: #10b981;
            font-weight: 600;
        }

        .negative {
            color: #ef4444;
            font-weight: 600;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        .error {
            background: #fee;
            color: #c00;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .logout-btn {
            background: #ef4444;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 20px;
        }

        .logout-btn:hover {
            background: #dc2626;
        }

        .period-selector {
            margin-bottom: 20px;
        }

        .period-selector select {
            padding: 10px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üìä CODEX Analytics Dashboard</h1>
            <p>–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ</p>
        </div>

        <!-- Login Section -->
        <div id="loginSection" class="login-section">
            <h2>üîê –í—Ö—ñ–¥</h2>
            <div id="errorMessage" class="error" style="display: none;"></div>
            <div class="form-group">
                <label for="apiUrl">API URL:</label>
                <input type="text" id="apiUrl" value="http://localhost:8001" placeholder="http://localhost:8001">
            </div>
            <div class="form-group">
                <label for="token">–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:</label>
                <input type="password" id="token" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à —Ç–æ–∫–µ–Ω">
            </div>
            <button class="btn" onclick="login()">–£–≤—ñ–π—Ç–∏</button>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="dashboard">
            <div class="period-selector">
                <label>–ü–µ—Ä—ñ–æ–¥: </label>
                <select id="periodSelect" onchange="loadAllData()">
                    <option value="7">–û—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤</option>
                    <option value="30" selected>–û—Å—Ç–∞–Ω–Ω—ñ 30 –¥–Ω—ñ–≤</option>
                    <option value="90">–û—Å—Ç–∞–Ω–Ω—ñ 90 –¥–Ω—ñ–≤</option>
                </select>
                <button class="logout-btn" onclick="logout()">–í–∏–π—Ç–∏</button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('overview')">üìä –û–≥–ª—è–¥</div>
                <div class="tab" onclick="switchTab('visitors')">üë• –í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ</div>
                <div class="tab" onclick="switchTab('revenue')">üí∞ –í–∏—Ç–æ—Ä–≥</div>
                <div class="tab" onclick="switchTab('marketing')">üìà –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</div>
            </div>

            <!-- Overview Tab -->
            <div id="overviewTab" class="tab-content active">
                <div class="stats-grid" id="statsGrid"></div>
                <div class="chart-container">
                    <h2>üìà –ì—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤ —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ–π</h2>
                    <div class="chart-wrapper">
                        <canvas id="overviewChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h2>üéØ –í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó</h2>
                    <div class="chart-wrapper">
                        <canvas id="funnelChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Visitors Tab -->
            <div id="visitorsTab" class="tab-content">
                <div class="chart-container">
                    <h2>üîç –î–∂–µ—Ä–µ–ª–∞ —Ç—Ä–∞—Ñ—ñ–∫—É</h2>
                    <div class="chart-wrapper">
                        <canvas id="trafficSourcesChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h2>üì± –ü—Ä–∏—Å—Ç—Ä–æ—ó</h2>
                    <div class="chart-wrapper">
                        <canvas id="devicesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Revenue Tab -->
            <div id="revenueTab" class="tab-content">
                <div class="chart-container">
                    <h2>üí∞ –í–∏—Ç–æ—Ä–≥ –ø–æ –¥–Ω—è—Ö</h2>
                    <div class="chart-wrapper">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h2>üí≥ –ü—ñ–¥–ø–∏—Å–∫–∏ –ø–æ —Ç–∞—Ä–∏—Ñ–∞—Ö</h2>
                    <div class="chart-wrapper">
                        <canvas id="subscriptionsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Marketing Tab -->
            <div id="marketingTab" class="tab-content">
                <div class="stats-grid" id="marketingStats"></div>
                <div class="chart-container">
                    <h2>üìä ROI –ø–æ –∫–∞–Ω–∞–ª–∞—Ö</h2>
                    <table id="roiTable">
                        <thead>
                            <tr>
                                <th>–ö–∞–Ω–∞–ª</th>
                                <th>–í–∏—Ç—Ä–∞—Ç–∏</th>
                                <th>–í–∏—Ç–æ—Ä–≥</th>
                                <th>–ü—Ä–∏–±—É—Ç–æ–∫</th>
                                <th>ROI</th>
                                <th>–ö–æ–Ω–≤–µ—Ä—Å—ñ—è</th>
                            </tr>
                        </thead>
                        <tbody id="roiTableBody"></tbody>
                    </table>
                </div>
                <div class="chart-container">
                    <h2>üéØ –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–∞–º–ø–∞–Ω—ñ–π</h2>
                    <table id="campaignsTable">
                        <thead>
                            <tr>
                                <th>–ö–∞–º–ø–∞–Ω—ñ—è</th>
                                <th>–ö–∞–Ω–∞–ª</th>
                                <th>–í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ</th>
                                <th>–ö–æ–Ω–≤–µ—Ä—Å—ñ—ó</th>
                                <th>ROI</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                        </thead>
                        <tbody id="campaignsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        let apiUrl = '';
        let authToken = '';
        let charts = {};

        function login() {
            apiUrl = document.getElementById('apiUrl').value;
            authToken = document.getElementById('token').value;

            if (!authToken) {
                showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Ç–æ–∫–µ–Ω');
                return;
            }

            // Test connection
            fetch(`${apiUrl}/api/owner/analytics/dashboard?days=30`, {
                headers: {
                    'Authorization': `Bearer ${authToken}`
                }
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('–ù–µ–≤—ñ—Ä–Ω–∏–π —Ç–æ–∫–µ–Ω –∞–±–æ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É');
                    }
                    return response.json();
                })
                .then(data => {
                    document.getElementById('loginSection').style.display = 'none';
                    document.getElementById('dashboardSection').style.display = 'block';
                    loadAllData();
                })
                .catch(error => {
                    showError(error.message);
                });
        }

        function logout() {
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('dashboardSection').style.display = 'none';
            document.getElementById('token').value = '';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
        }

        async function loadAllData() {
            const days = document.getElementById('periodSelect').value;

            try {
                // Load overview data
                const dashboard = await fetchAPI(`/api/owner/analytics/dashboard?days=${days}`);
                displayStats(dashboard.summary);
                displayOverviewChart(dashboard);
                displayFunnelChart(dashboard.conversion_funnel);
                displayTrafficSources(dashboard.traffic_sources);
                displayDevices(dashboard.device_statistics);

                // Load revenue data
                const revenue = await fetchAPI(`/api/owner/analytics/revenue?days=${days}`);
                displayRevenueChart(revenue);
                displaySubscriptionsChart(dashboard.subscription_statistics);

                // Load marketing data
                try {
                    const roi = await fetchAPI(`/api/owner/analytics/marketing/roi?days=${days}`);
                    const cac = await fetchAPI(`/api/owner/analytics/marketing/cac?days=${days}`);
                    const campaigns = await fetchAPI(`/api/owner/analytics/marketing/campaigns?days=${days}`);

                    displayMarketingStats(cac);
                    displayROITable(roi.channels);
                    displayCampaignsTable(campaigns.campaigns);
                } catch (e) {
                    console.log('Marketing data not available:', e);
                }
            } catch (error) {
                showError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö: ' + error.message);
            }
        }

        async function fetchAPI(endpoint) {
            const response = await fetch(`${apiUrl}${endpoint}`, {
                headers: {
                    'Authorization': `Bearer ${authToken}`
                }
            });
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}`);
            }
            return response.json();
        }

        function displayStats(summary) {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <h3>–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ</h3>
                    <div class="value">${summary.unique_visitors.toLocaleString()}</div>
                    <div class="label">–≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <h3>–ü–µ—Ä–µ–≥–ª—è–¥–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫</h3>
                    <div class="value">${summary.total_page_views.toLocaleString()}</div>
                    <div class="label">–ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <h3>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó</h3>
                    <div class="value">${summary.registrations.toLocaleString()}</div>
                    <div class="label">–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <h3>–ê–∫—Ç–∏–≤–Ω—ñ –ø—ñ–¥–ø–∏—Å–∫–∏</h3>
                    <div class="value">${summary.active_subscriptions.toLocaleString()}</div>
                    <div class="label">–ø—ñ–¥–ø–∏—Å–æ–∫</div>
                </div>
                <div class="stat-card">
                    <h3>–í–∏—Ç–æ—Ä–≥</h3>
                    <div class="value">${(summary.total_revenue / 100).toFixed(2)} ‚Ç¨</div>
                    <div class="label">—î–≤—Ä–æ</div>
                </div>
            `;
        }

        function displayMarketingStats(cac) {
            const statsGrid = document.getElementById('marketingStats');
            const isHealthy = cac.is_healthy;
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <h3>CAC (–ü–ª–∞—Ç–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏)</h3>
                    <div class="value">${(cac.cac_paid_customers / 100).toFixed(2)} ‚Ç¨</div>
                    <div class="label">–∑–∞ –∫–ª—ñ—î–Ω—Ç–∞</div>
                </div>
                <div class="stat-card">
                    <h3>–°–µ—Ä–µ–¥–Ω—ñ–π LTV</h3>
                    <div class="value">${(cac.average_ltv / 100).toFixed(2)} ‚Ç¨</div>
                    <div class="label">–Ω–∞ –∫–ª—ñ—î–Ω—Ç–∞</div>
                </div>
                <div class="stat-card">
                    <h3>LTV:CAC Ratio</h3>
                    <div class="value ${isHealthy ? 'positive' : 'negative'}">${cac.ltv_cac_ratio.toFixed(2)}</div>
                    <div class="label">${isHealthy ? '‚úÖ –ó–¥–æ—Ä–æ–≤–∏–π' : '‚ö†Ô∏è –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–∫—Ä–∞—â–∏—Ç–∏'}</div>
                </div>
                <div class="stat-card">
                    <h3>–í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥</h3>
                    <div class="value">${(cac.total_marketing_cost / 100).toFixed(2)} ‚Ç¨</div>
                    <div class="label">—î–≤—Ä–æ</div>
                </div>
            `;
        }

        function displayOverviewChart(data) {
            const ctx = document.getElementById('overviewChart');
            if (charts.overview) charts.overview.destroy();

            // Get chart data
            fetchAPI(`/api/owner/analytics/charts/visitors?days=${document.getElementById('periodSelect').value}`)
                .then(visitorsData => {
                    return fetchAPI(`/api/owner/analytics/charts/registrations?days=${document.getElementById('periodSelect').value}`)
                        .then(registrationsData => {
                            charts.overview = new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: visitorsData.chart_data.map(d => d.date),
                                    datasets: [{
                                        label: '–í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ',
                                        data: visitorsData.chart_data.map(d => d.value),
                                        borderColor: '#667eea',
                                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                        tension: 0.4
                                    }, {
                                        label: '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó',
                                        data: registrationsData.chart_data.map(d => d.value),
                                        borderColor: '#10b981',
                                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            position: 'top',
                                        }
                                    }
                                }
                            });
                        });
                });
        }

        function displayFunnelChart(funnel) {
            const ctx = document.getElementById('funnelChart');
            if (charts.funnel) charts.funnel.destroy();

            charts.funnel = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: funnel.funnel.map(f => f.step),
                    datasets: [{
                        label: '–ö—ñ–ª—å–∫—ñ—Å—Ç—å',
                        data: funnel.funnel.map(f => f.count),
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function displayTrafficSources(sources) {
            const ctx = document.getElementById('trafficSourcesChart');
            if (charts.traffic) charts.traffic.destroy();

            charts.traffic = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: sources.map(s => s.source),
                    datasets: [{
                        data: sources.map(s => s.count),
                        backgroundColor: [
                            '#667eea', '#764ba2', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function displayDevices(devices) {
            const ctx = document.getElementById('devicesChart');
            if (charts.devices) charts.devices.destroy();

            charts.devices = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: devices.devices.map(d => d.type),
                    datasets: [{
                        data: devices.devices.map(d => d.count),
                        backgroundColor: ['#667eea', '#10b981', '#f59e0b']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function displayRevenueChart(revenue) {
            const ctx = document.getElementById('revenueChart');
            if (charts.revenue) charts.revenue.destroy();

            charts.revenue = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: revenue.revenue_chart.map(r => r.date),
                    datasets: [{
                        label: '–í–∏—Ç–æ—Ä–≥ (‚Ç¨)',
                        data: revenue.revenue_chart.map(r => r.value / 100),
                        backgroundColor: 'rgba(16, 185, 129, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function displaySubscriptionsChart(subscriptions) {
            const ctx = document.getElementById('subscriptionsChart');
            if (charts.subscriptions) charts.subscriptions.destroy();

            charts.subscriptions = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: subscriptions.plans.map(p => p.plan_type),
                    datasets: [{
                        label: '–ö—ñ–ª—å–∫—ñ—Å—Ç—å',
                        data: subscriptions.plans.map(p => p.count),
                        backgroundColor: 'rgba(102, 126, 234, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function displayROITable(channels) {
            const tbody = document.getElementById('roiTableBody');
            tbody.innerHTML = channels.map(ch => `
                <tr>
                    <td><strong>${ch.channel}</strong></td>
                    <td>${(ch.cost / 100).toFixed(2)} ‚Ç¨</td>
                    <td>${(ch.revenue / 100).toFixed(2)} ‚Ç¨</td>
                    <td class="${ch.profit >= 0 ? 'positive' : 'negative'}">${(ch.profit / 100).toFixed(2)} ‚Ç¨</td>
                    <td class="${ch.roi >= 0 ? 'positive' : 'negative'}">${ch.roi.toFixed(2)}%</td>
                    <td>${ch.conversion_rate.toFixed(2)}%</td>
                </tr>
            `).join('');
        }

        function displayCampaignsTable(campaigns) {
            const tbody = document.getElementById('campaignsTableBody');
            tbody.innerHTML = campaigns.map(c => `
                <tr>
                    <td><strong>${c.campaign_name}</strong></td>
                    <td>${c.channel}</td>
                    <td>${c.visitors}</td>
                    <td>${c.paid_subscriptions}</td>
                    <td class="${c.roi >= 0 ? 'positive' : 'negative'}">${c.roi.toFixed(2)}%</td>
                    <td><span class="badge ${c.is_active ? 'badge-success' : 'badge-warning'}">${c.is_active ? '–ê–∫—Ç–∏–≤–Ω–∞' : '–ù–µ–∞–∫—Ç–∏–≤–Ω–∞'}</span></td>
                </tr>
            `).join('');
        }
    </script>
</body>

</html>